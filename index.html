<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SFS Project Hub</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body {
  font-family: Arial, sans-serif; margin:0; padding:0;
  background:#0d1b2a; color:white; text-align:center;
}
canvas { position:fixed; top:0; left:0; width:100%; height:100%; z-index:-1; }
h1 { margin:20px; font-size:2.2em; text-shadow:2px 2px 10px rgba(0,0,0,0.6); }
.container { margin:20px auto; max-width:900px; }
input, textarea {
  padding:10px; margin:5px; border:none; border-radius:5px; width:90%;
}
button {
  padding:10px 20px; margin:5px;
  border:none; border-radius:5px;
  background:#00c6ff; cursor:pointer; font-weight:bold;
}
button:hover { background:#0096c7; }
#result { margin-top:20px; }
.card {
  background:#193d63; border-radius:10px; padding:15px; margin:10px auto;
  max-width:700px; text-align:left; box-shadow:0px 4px 15px rgba(0,0,0,0.3);
}
.card h2 { color:#ffdd57; margin:0 0 5px; }

@media (max-width:768px) { h1{font-size:1.8em;} .card{padding:15px;} input,button{flex:1 1 100%; max-width:none;} }
@media (max-width:480px) { h1{font-size:1.5em;} .card{padding:12px;} .search-container{gap:8px;} }

a { color:white; text-decoration:none; }
</style>
</head>
<body>
<canvas id="bgCanvas"></canvas>
<h1>SFS Project Hub</h1>

<div class="container">
  <!-- Search Section -->
  <h2>üîç Search Project</h2>
  <input type="text" id="searchBox" placeholder="Search by project or student name...">
  <button onclick="searchProject()">Search</button>
  <div id="result"></div>

  <!-- Add Project Section -->
  <h2>‚ûï Add New Project</h2>
  <form id="projectForm" onsubmit="addProject(event)">
    <input type="text" id="pname" placeholder="Project Name" required><br>
    <textarea id="psummary" placeholder="Summary" required></textarea><br>
    <input type="text" id="pcreatedBy" placeholder="Created By" required><br>
    <textarea id="pdetails" placeholder="Details"></textarea><br>
    <input type="text" id="pclass" placeholder="Class" required><br>
    <input type="text" id="ptime" placeholder="Time Created"><br>
    <input type="text" id="pdisplayed" placeholder="Project Displayed Location"><br>
    <input type="number" id="pcost" placeholder="Cost of Items"><br>
    <button type="submit">Add Project</button>
  </form>

  <div>
    <button>
      <a href="about.html" target="_blank">About</a>
    </button>
  </div>
</div>

<script>
const scriptURL = "https://script.google.com/macros/s/AKfycbzH-T8-dthF-EiTUUw5MFOWT9nfHnHNNvMY7OO5PC2Ny81ju3952Y4gM07DjqJrjzKFpw/exec"; // Replace with your Google Apps Script Web App URL

let allProjects = [];

// Fetch projects from Google Sheet
function loadProjects() {
  fetch(scriptURL)
    .then(res => res.json())
    .then((projects) => {
      allProjects = projects;
      displayProjects(projects);
    })
    .catch(err => console.error("Error fetching projects:", err));
}

// Display projects in result div
function displayProjects(projects) {
  const resultDiv = document.getElementById("result");
  resultDiv.innerHTML = "";
  if (projects.length === 0) {
    resultDiv.innerHTML = "<p>No projects found.</p>";
    return;
  }
  projects.forEach(p => {
    const div = document.createElement("div");
    div.classList.add("card");
    div.innerHTML = `
      <h2>${p.projectName}</h2>
      <p><b>Summary:</b> ${p.summary}</p>
      <p><b>Created By:</b> ${p.createdBy}</p>
      <p><b>Details:</b> ${p.details ?? "NA"}</p>
      <p><b>Class:</b> ${p.class ?? "NA"}</p>
      <p><b>Time Created:</b> ${p.Timecreated ? new Date(p.Timecreated).toLocaleString() : "NA"}</p>
      <p><b>Project Displayed:</b> ${p.projectdisplayed ?? "NA"}</p>
      <p><b>Cost of items:</b> ${p.costitems ?? "NA"}</p>
    `;
    resultDiv.appendChild(div);
  });
}

// Search projects
function searchProject() {
  const query = document.getElementById("searchBox").value.toLowerCase();
  const filtered = allProjects.filter(p =>
    p.projectName.toLowerCase().includes(query) ||
    p.createdBy.toLowerCase().includes(query)
  );
  displayProjects(filtered);
}

// Add new project
function addProject(e) {
  e.preventDefault();
  const newProj = {
    projectName: document.getElementById("pname").value,
    summary: document.getElementById("psummary").value,
    createdBy: document.getElementById("pcreatedBy").value,
    details: document.getElementById("pdetails").value,
    class: document.getElementById("pclass").value,
    Timecreated: document.getElementById("ptime").value,
    projectdisplayed: document.getElementById("pdisplayed").value,
    costitems: document.getElementById("pcost").value
  };

  // Send to Google Sheet
  fetch(scriptURL, {
    method: "POST",
    body: JSON.stringify(newProj)
  })
  .then(res => res.text())
  .then(() => {
    alert("‚úÖ Project added successfully!");
    document.getElementById("projectForm").reset();
    loadProjects(); // refresh projects
  })
  .catch(err => alert("Error adding project: " + err));
}

// Particle background
const canvas = document.getElementById("bgCanvas");
const ctx = canvas.getContext("2d");
let particles = [];
function resizeCanvas(){ canvas.width=window.innerWidth; canvas.height=window.innerHeight; }
window.addEventListener("resize", resizeCanvas); resizeCanvas();
class Particle{constructor(){this.x=Math.random()*canvas.width;this.y=Math.random()*canvas.height;this.size=Math.random()*3+1;this.speedX=(Math.random()-0.5)*1.5;this.speedY=(Math.random()-0.5)*1.5;} update(){this.x+=this.speedX;this.y+=this.speedY;if(this.x<0||this.x>canvas.width)this.speedX*=-1;if(this.y<0||this.y>canvas.height)this.speedY*=-1;} draw(){ctx.beginPath();ctx.arc(this.x,this.y,this.size,0,Math.PI*2);ctx.fillStyle="rgba(255,255,255,0.7)";ctx.fill();}}
function initParticles(){particles=[];for(let i=0;i<100;i++){particles.push(new Particle());}}
function animate(){ctx.clearRect(0,0,canvas.width,canvas.height);particles.forEach(p=>{p.update();p.draw();});requestAnimationFrame(animate);}
initParticles(); animate();

window.onload = loadProjects;
</script>
</body>
</html>
